<Window x:Class="CellCAD.views.PouchCellWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:CellCAD.converters"
        mc:Ignorable="d"
        Title="CellCAD – Pouch Cell Stack Designer" Height="900" Width="1600">

    <Window.Resources>
        <!-- Converters -->
        <converters:BoolToVisibilityConverter x:Key="BoolToVis"/>
        <converters:EnumToBooleanConverter x:Key="EnumToBool"/>
        <converters:NullToDashConverter x:Key="NullToDash"/>

        <!-- Color Definitions -->
        <SolidColorBrush x:Key="ActiveTabBrush" Color="#0078D4"/>
        <SolidColorBrush x:Key="InactiveTabBrush" Color="#E8E8E8"/>
        <SolidColorBrush x:Key="InputFieldBrush" Color="Black"/>
        <SolidColorBrush x:Key="CalculatedFieldBrush" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="HeaderBrush" Color="#444444"/>
        <SolidColorBrush x:Key="SubHeaderBrush" Color="#666666"/>

        <!-- Style for input text boxes (user editable - BLACK background) -->
        <Style x:Key="InputTextBox" TargetType="TextBox">
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="Black"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderBrush" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Style for calculated/read-only fields (GRAY background) -->
        <Style x:Key="CalcTextBox" TargetType="TextBox">
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#CCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Style for tab buttons on the left (BLUE when active) -->
        <Style x:Key="MainTabStyle" TargetType="RadioButton">
            <Setter Property="Height" Value="50"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="Border" Background="#E8E8E8" BorderBrush="#CCC" BorderThickness="1" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#0078D4"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#D0D0D0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style for sub-tabs within main sections -->
        <Style x:Key="SubTabStyle" TargetType="RadioButton">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Margin" Value="8,2,0,2"/>
            <Setter Property="Padding" Value="8,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="Border" Background="#F0F0F0" BorderBrush="#DDD" BorderThickness="1" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#0078D4"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#E0E0E0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Table header style -->
        <Style x:Key="TableHeader" TargetType="Border">
            <Setter Property="Background" Value="#444444"/>
            <Setter Property="Padding" Value="4,8"/>
            <Setter Property="BorderBrush" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Table header text style -->
        <Style x:Key="HeaderText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <!-- Top header bar -->
            <RowDefinition Height="Auto"/>
            <!-- Main content -->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ========== TOP HEADER BAR ========== -->
        <Border Grid.Row="0" Background="#E0E0E0" BorderBrush="#AAA" BorderThickness="0,0,0,1" Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Cell Name -->
                <TextBlock Grid.Column="0" Text="Cell Name" VerticalAlignment="Center" Margin="0,0,12,0" FontWeight="SemiBold"/>
                <ComboBox Grid.Column="1" Margin="0,0,24,0" Background="#666" Foreground="DarkBlue" FontWeight="SemiBold">
                    <ComboBoxItem Content="PRIMA Cell - FCL" IsSelected="True"/>
                </ComboBox>

                <!-- Version -->
                <TextBlock Grid.Column="2" Text="Version" VerticalAlignment="Center" Margin="0,0,12,0" FontWeight="SemiBold"/>
                <ComboBox Grid.Column="3" Margin="0,0,24,0" Background="#666" Foreground="DarkGreen" FontWeight="SemiBold">
                    <ComboBoxItem Content="Version 3 – 01.10.25" IsSelected="True"/>
                </ComboBox>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="5" Orientation="Horizontal">
                    <Button Content="Update" Padding="16,6" Margin="4,0" BorderBrush="Black" BorderThickness="2" Background="White"/>
                    <Button Content="Save as" Padding="16,6" Margin="4,0" BorderBrush="Black" BorderThickness="2" Background="White"/>
                    <Button Content="Delete" Padding="16,6" Margin="4,0" BorderBrush="Black" BorderThickness="2" Background="White"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== MAIN CONTENT with GLOBAL SCROLLVIEWER ========== -->
        <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Auto"
                      CanContentScroll="True">
            <Grid>
                <Grid.ColumnDefinitions>
                    <!-- LEFT: Navigation sidebar -->
                    <ColumnDefinition Width="180" MinWidth="160"/>

                    <!-- CENTER: Parameter panels (Sheet Design, Stack Config, Packaging, Report) -->
                    <ColumnDefinition Width="*" MinWidth="700"/>

                    <!-- SPLITTER / helper column -->
                    <ColumnDefinition Width="Auto"/>

                    <!-- RIGHT: Preview panels -->
                    <ColumnDefinition Width="380" MinWidth="360" MaxWidth="420"/>
                </Grid.ColumnDefinitions>

                <!-- ========== LEFT SIDEBAR: MAIN TAB NAVIGATION ========== -->
                <Border Grid.Column="0" Background="#F0F0F0" BorderBrush="#AAA" BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Top: Navigation tabs -->
                        <StackPanel Grid.Row="0" Margin="8">
                            <TextBlock Text="Navigation" FontWeight="Bold" FontSize="12" Margin="0,8,0,8" Foreground="#666"/>

                            <!-- Main Section Tabs -->
                            <RadioButton x:Name="TabSheetDesign" Content="Sheet Design" Style="{StaticResource MainTabStyle}" IsChecked="True" GroupName="MainTabs"/>
                            <RadioButton x:Name="TabStackConfig" Content="Stack Config." Style="{StaticResource MainTabStyle}" GroupName="MainTabs"/>
                            <RadioButton x:Name="TabPackaging" Content="Packaging" Style="{StaticResource MainTabStyle}" GroupName="MainTabs"/>

                            <!-- Sub-tabs for Packaging (visible when Packaging is selected) -->
                            <StackPanel Visibility="{Binding IsChecked, ElementName=TabPackaging, Converter={StaticResource BoolToVis}}">
                                <RadioButton x:Name="SubTabCase" Content="Case" Style="{StaticResource SubTabStyle}" IsChecked="True" GroupName="PackagingSubTabs"/>
                                <RadioButton x:Name="SubTabTabs" Content="Tabs" Style="{StaticResource SubTabStyle}" GroupName="PackagingSubTabs"/>
                                <RadioButton x:Name="SubTabAddFoils" Content="Add. Foils" Style="{StaticResource SubTabStyle}" GroupName="PackagingSubTabs"/>
                                <RadioButton x:Name="SubTabFixingTape" Content="Fixing Tape" Style="{StaticResource SubTabStyle}" GroupName="PackagingSubTabs"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Bottom: Calculations section -->
                        <StackPanel Grid.Row="1" Margin="8,0,8,8">
                            <TextBlock Text="Calculations" FontWeight="Bold" FontSize="12" Margin="0,8,0,8" Foreground="#666"/>

                            <!-- Report Main Tab -->
                            <RadioButton x:Name="TabReport" Content="Report" Style="{StaticResource MainTabStyle}" GroupName="MainTabs"/>

                            <!-- Sub-tabs for Report (visible when Report is selected) -->
                            <StackPanel Visibility="{Binding IsChecked, ElementName=TabReport, Converter={StaticResource BoolToVis}}">
                                <RadioButton x:Name="SubTabReportCore" Content="Core" Style="{StaticResource SubTabStyle}" IsChecked="True" GroupName="ReportSubTabs"/>
                                <RadioButton x:Name="SubTabReportComp" Content="Comp." Style="{StaticResource SubTabStyle}" GroupName="ReportSubTabs"/>
                            </StackPanel>

                            <Button Content="BoM" Padding="8,12" Margin="0,2" Background="White" BorderBrush="Black" BorderThickness="2" FontWeight="SemiBold"/>
                            <Button Content="Export - CSV" Padding="8,12" Margin="0,2" Background="White" BorderBrush="Black" BorderThickness="2" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- ========== CENTER: PARAMETER PANELS ========== -->
                <Border Grid.Column="1" Padding="16">
                <StackPanel>

                    <!-- ========== SHEET DESIGN PANEL ========== -->
                    <Grid x:Name="PanelSheetDesign" Visibility="{Binding IsChecked, ElementName=TabSheetDesign, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <TextBlock Text="Sheet Design" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

                            <!-- Sheet Dimensions Table -->
                            <TextBlock Text="Sheet Dimensions" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"/>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Headers -->
                                <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="Sheet Dimensions" Style="{StaticResource HeaderText}" HorizontalAlignment="Left"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="[mm]" Style="{StaticResource HeaderText}"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="Cathode" Style="{StaticResource HeaderText}"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="Anode" Style="{StaticResource HeaderText}"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="Separator" Style="{StaticResource HeaderText}"/>
                                </Border>

                                <!-- Height (y) row -->
                                <Border Grid.Row="1" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Height (y)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}" 
                                             Text="{Binding CathodeHeight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" 
                                             Text="{Binding AnodeHeight_mm, Mode=OneWay}"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" 
                                             Text="{Binding SeparatorHeight_mm, Mode=OneWay}"/>
                                </Border>

                                <!-- Width (x) row -->
                                <Border Grid.Row="2" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Width (x)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}" 
                                             Text="{Binding CathodeWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" 
                                             Text="{Binding AnodeWidth_mm, Mode=OneWay}"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" 
                                             Text="{Binding SeparatorWidth_mm, Mode=OneWay}"/>
                                </Border>

                                <!-- Area row -->
                                <Border Grid.Row="3" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Area" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[cm²]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" Text="{Binding CathodeArea_cm2, StringFormat=F1, Mode=OneWay}"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" Text="{Binding AnodeArea_cm2, StringFormat=F1, Mode=OneWay}"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource CalcTextBox}" Text="{Binding SeparatorArea_cm2, StringFormat=F1, Mode=OneWay}"/>
                                </Border>

                                <!-- Offsets Section Header -->
                                <Border Grid.Row="4" Grid.Column="0" Background="#666666" Padding="4,8" BorderBrush="White" BorderThickness="1" Grid.ColumnSpan="5">
                                    <TextBlock Text="Offsets to Cathode" Foreground="White" FontWeight="Bold"/>
                                </Border>

                                <!-- Offsets Section Header -->
                                <Border Grid.Row="4" Grid.Column="0" Background="#666666" Padding="4,8" BorderBrush="White" BorderThickness="1" Grid.ColumnSpan="5">
                                    <TextBlock Text="Offsets to Cathode" Foreground="White" FontWeight="Bold"/>
                                </Border>

                                <!-- Offset Height (y) -->
                                <Border Grid.Row="5" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Height (y)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="5" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="5" Grid.Column="2" Background="#888" Padding="2" BorderBrush="#CCC" BorderThickness="1"/>
                                <Border Grid.Row="5" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <!-- InputTextBox (BLACK) with TwoWay binding -->
                                    <TextBox Style="{StaticResource InputTextBox}" 
                                             Text="{Binding AnodeOffsetY_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="5" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <!-- InputTextBox (BLACK) with TwoWay binding -->
                                    <TextBox Style="{StaticResource InputTextBox}" 
                                             Text="{Binding SeparatorOffsetY_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             PreviewTextInput="NumericOnly"/>
                                </Border>

                                <!-- Offset Width (x) -->
                                <Border Grid.Row="6" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Width (x)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="6" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="6" Grid.Column="2" Background="#888" Padding="2" BorderBrush="#CCC" BorderThickness="1"/>
                                <Border Grid.Row="6" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <!-- InputTextBox (BLACK) with TwoWay binding -->
                                    <TextBox Style="{StaticResource InputTextBox}" 
                                             Text="{Binding AnodeOffsetX_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="6" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <!-- InputTextBox (BLACK) with TwoWay binding -->
                                    <TextBox Style="{StaticResource InputTextBox}" 
                                             Text="{Binding SeparatorOffsetX_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                            </Grid>

                            <!-- Flag Positions -->
                            <TextBlock Text="Flag Positions" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <CheckBox Content="Opposite Sides" IsChecked="{Binding FlagsOnOppositeSides}" Margin="0,0,16,0"/>
                                <CheckBox Content="Same Sides" IsChecked="{Binding FlagsOnSameSide}"/>
                            </StackPanel>

                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"/>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Headers -->
                                <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="Cathode" Style="{StaticResource HeaderText}"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource TableHeader}">
                                    <TextBlock Text="Anode" Style="{StaticResource HeaderText}"/>
                                </Border>

                                <!-- Height (y) -->
                                <Border Grid.Row="1" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Height (y)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}"
                                             Text="{Binding CathodeFlagHeight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}"
                                             Text="{Binding AnodeFlagHeight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="NumericOnly"/>
                                </Border>

                                <!-- Width (x) -->
                                <Border Grid.Row="2" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Width (x)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}"
                                             Text="{Binding CathodeFlagWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}"
                                             Text="{Binding AnodeFlagWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="NumericOnly"/>
                                </Border>

                                <!-- Offset (x) -->
                                <Border Grid.Row="3" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="Offset (x)" VerticalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}"
                                             Text="{Binding CathodeFlagOffsetX_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                    <TextBox Style="{StaticResource InputTextBox}"
                                             Text="{Binding AnodeFlagOffsetX_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="NumericOnly"/>
                                </Border>
                            </Grid>

                            <!-- Update Stack Dimensions -->
                            <Border Background="#F0F0F0" Padding="12" Margin="0,24,0,0" BorderBrush="#CCC" BorderThickness="1">
                                <StackPanel>
                                    <CheckBox Content="Update Stack Dimensions" IsChecked="{Binding UpdateStackDimensions}" 
                                              FontWeight="SemiBold" Margin="0,0,0,8"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="60"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <Border Grid.Row="0" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                            <TextBlock Text="Height (y)" VerticalAlignment="Center"/>
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                            <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                            <TextBox Style="{StaticResource InputTextBox}"
                                                     Text="{Binding StackHeight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                     IsEnabled="{Binding UpdateStackDimensions}"
                                                     PreviewTextInput="NumericOnly"/>
                                        </Border>

                                        <Border Grid.Row="1" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                            <TextBlock Text="Width (x)" VerticalAlignment="Center"/>
                                        </Border>
                                        <Border Grid.Row="1" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                            <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        </Border>
                                        <Border Grid.Row="1" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                            <TextBox Style="{StaticResource InputTextBox}"
                                                     Text="{Binding StackWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                     IsEnabled="{Binding UpdateStackDimensions}"
                                                     PreviewTextInput="NumericOnly"/>
                                        </Border>
                                    </Grid>
                                    <TextBlock Text="*Values must be between anode and separator dimensions" 
                                               FontStyle="Italic" FontSize="10" Foreground="#666" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>

                    <!-- ========== STACK CONFIGURATION PANEL ========== -->
                    <Grid x:Name="PanelStackConfig" Visibility="{Binding IsChecked, ElementName=TabStackConfig, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <TextBlock Text="Stack Configuration" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

                            <!-- Cell Configuration -->
                            <TextBlock Text="Cell Configuration" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="250"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Number of stacks in cell" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Style="{StaticResource InputTextBox}"
                                         Text="{Binding NumberOfStacksInCell, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericOnly" Margin="4"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Number of electrode pairs in stack" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource InputTextBox}"
                                         Text="{Binding ElectrodePairsPerStack, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericOnly" Margin="4"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Number of electrode pairs in cell" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                         Text="{Binding ElectrodePairsInCell, Mode=OneWay}"
                                         IsReadOnly="True" Margin="4"/>
                            </Grid>

                            <!-- End Electrodes -->
                            <TextBlock Text="End Electrodes in Stack" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                    <RadioButton Content="Both Negative" GroupName="EndElectrodes"
                                                 IsChecked="{Binding EndElectrodes, Converter={StaticResource EnumToBool}, ConverterParameter=BothNegative}"
                                                 Margin="0,4"/>
                                    <RadioButton Content="Both Positive" GroupName="EndElectrodes"
                                                 IsChecked="{Binding EndElectrodes, Converter={StaticResource EnumToBool}, ConverterParameter=BothPositive}"
                                                 Margin="0,4"/>
                                    <RadioButton Content="Positive/Negative" GroupName="EndElectrodes"
                                                 IsChecked="{Binding EndElectrodes, Converter={StaticResource EnumToBool}, ConverterParameter=PositiveNegative}"
                                                 Margin="0,4"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="Coatings at End Electrodes" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                    <RadioButton Content="Both double sided" GroupName="EndCoatings"
                                                 IsChecked="{Binding EndCoatings, Converter={StaticResource EnumToBool}, ConverterParameter=BothDoubleSided}"
                                                 Margin="0,4"/>
                                    <RadioButton Content="1 single sided" GroupName="EndCoatings"
                                                 IsChecked="{Binding EndCoatings, Converter={StaticResource EnumToBool}, ConverterParameter=OneSingleSided}"
                                                 Margin="0,4"/>
                                    <RadioButton Content="Both single sided" GroupName="EndCoatings"
                                                 IsChecked="{Binding EndCoatings, Converter={StaticResource EnumToBool}, ConverterParameter=BothSingleSided}"
                                                 Margin="0,4"/>
                                </StackPanel>
                            </Grid>

                            <!-- Additional Elements -->
                            <TextBlock Text="Additional Elements" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="250"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Separator overwraps (each stack)" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Style="{StaticResource InputTextBox}"
                                         Text="{Binding SeparatorOverwrapsPerStack, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericOnly" Margin="4"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Add. overwrap (each stack)" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource InputTextBox}"
                                         Text="{Binding AdditionalOverwrapsPerStack, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericOnly" Margin="4"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Insulation Shell (around all stacks)" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource InputTextBox}"
                                         Text="{Binding InsulationShellAroundAllStacks, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericOnly" Margin="4"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Fixing Tapes" VerticalAlignment="Center" Margin="4"/>
                                <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource InputTextBox}"
                                         Text="{Binding FixingTapesPerStack, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PreviewTextInput="NumericOnly" Margin="4"/>
                            </Grid>

                            <!-- Fixing Tapes Option -->
                            <CheckBox x:Name="FixingTapesOnAllStacksCheckBox"
                                      Content="Fixing Tapes on all stacks?"
                                      IsChecked="{Binding FixingTapesOnAllStacks, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                      Margin="0,4,0,8"
                                      ToolTip="When checked, applies the same number of fixing tapes to every stack in the cell."/>

                            <!-- Calculated Thickness -->
                            <TextBlock Text="Calculated Thickness" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                            <Border BorderBrush="#CCC" BorderThickness="1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Headers -->
                                    <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="Calculated Thickness" Style="{StaticResource HeaderText}" HorizontalAlignment="Left"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="Unit" Style="{StaticResource HeaderText}"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="Dry Electrodes" Style="{StaticResource HeaderText}"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="0% SoC" Style="{StaticResource HeaderText}"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="100% SoC" Style="{StaticResource HeaderText}"/>
                                    </Border>

                                    <!-- Single Stack -->
                                    <Border Grid.Row="1" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Single Stack" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SingleStackThickness_Dry, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SingleStackThickness_SoC0, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SingleStackThickness_SoC100, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>

                                    <!-- All Stacks and add. elements -->
                                    <Border Grid.Row="2" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="All Stacks and add. elements" VerticalAlignment="Center" TextWrapping="Wrap"/>
                                    </Border>
                                    <Border Grid.Row="2" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="2" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding AllStacksThickness_Dry, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="2" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding AllStacksThickness_SoC0, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="2" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding AllStacksThickness_SoC100, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>

                                    <!-- Cell outer thickness -->
                                    <Border Grid.Row="3" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Cell outer thickness" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="3" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="3" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding CellOuterThickness_Dry, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="3" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding CellOuterThickness_SoC0, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="3" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding CellOuterThickness_SoC100, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>

                                    <!-- Swelling Stack -->
                                    <Border Grid.Row="4" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Swelling Stack" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="4" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="[%]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="4" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False" Text="—"/>
                                    </Border>
                                    <Border Grid.Row="4" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SwellingStack_SoC0, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="4" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SwellingStack_SoC100, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>

                                    <!-- Swelling Cell -->
                                    <Border Grid.Row="5" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Swelling Cell" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="5" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="[%]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="5" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False" Text="—"/>
                                    </Border>
                                    <Border Grid.Row="5" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SwellingCell_SoC0, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                    <Border Grid.Row="5" Grid.Column="4" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True" IsEnabled="False"
                                                 Text="{Binding SwellingCell_SoC100, Mode=OneWay, Converter={StaticResource NullToDash}}"/>
                                    </Border>
                                </Grid>
                            </Border>

                            <!-- Number of Sheet Layers -->
                            <TextBlock Text="Number of Sheet Layers (in z)" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                            <Border BorderBrush="#CCC" BorderThickness="1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="250"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Headers -->
                                    <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="Sheet Layers (in z)" Style="{StaticResource HeaderText}" HorizontalAlignment="Left"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="Stack" Style="{StaticResource HeaderText}"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeader}">
                                        <TextBlock Text="Cell" Style="{StaticResource HeaderText}"/>
                                    </Border>

                                    <!-- Data rows -->
                                    <Border Grid.Row="1" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="All Electrode Sheets" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding AllElectrodeSheets_Stack, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding AllElectrodeSheets_Cell, Mode=OneWay}"/>
                                    </Border>

                                    <Border Grid.Row="2" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Cathode Sheets" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="2" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding CathodeSheets_Stack, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="2" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding CathodeSheets_Cell, Mode=OneWay}"/>
                                    </Border>

                                    <Border Grid.Row="3" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Anode Sheets" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="3" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding AnodeSheets_Stack, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="3" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding AnodeSheets_Cell, Mode=OneWay}"/>
                                    </Border>

                                    <Border Grid.Row="4" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Separator Sheets" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="4" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding SeparatorSheets_Stack, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="4" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding SeparatorSheets_Cell, Mode=OneWay}"/>
                                    </Border>

                                    <Border Grid.Row="5" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Overwrap" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="5" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding Overwrap_Stack, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="5" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding Overwrap_Cell, Mode=OneWay}"/>
                                    </Border>

                                    <Border Grid.Row="6" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Insulation Shell" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="6" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding InsulationShell_Stack, StringFormat=F1, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="6" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding InsulationShell_Cell, Mode=OneWay}"/>
                                    </Border>

                                    <Border Grid.Row="7" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBlock Text="Fixing Tape" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Row="7" Grid.Column="1" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding FixingTape_Stack, Mode=OneWay}"/>
                                    </Border>
                                    <Border Grid.Row="7" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                        <TextBox Style="{StaticResource CalcTextBox}" IsReadOnly="True"
                                                 Text="{Binding FixingTape_Cell, Mode=OneWay}"/>
                                    </Border>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </Grid>

                    <!-- ========== PACKAGING PANELS ========== -->
                    <Grid x:Name="PanelPackaging" Visibility="{Binding IsChecked, ElementName=TabPackaging, Converter={StaticResource BoolToVis}}">
                        <StackPanel>

                            <!-- CASE SUB-TAB -->
                            <Grid x:Name="SubPanelCase" Visibility="{Binding IsChecked, ElementName=SubTabCase, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <TextBlock Text="Packaging / Case" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

                                        <!-- Package Material Selection -->
                                        <TextBlock Text="Package Material" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                        <ComboBox Margin="0,0,0,16">
                                            <ComboBoxItem Content="PET Foil 100 um" IsSelected="True"/>
                                            <ComboBoxItem Content="Aluminum Laminate 120 um"/>
                                            <ComboBoxItem Content="Custom Material"/>
                                        </ComboBox>

                                        <!-- Package Material Composition Table -->
                                    <TextBlock Text="Package Material Composition" FontSize="14" FontWeight="SemiBold" Margin="0,16,0,8"/>
                                    <DataGrid ItemsSource="{Binding CaseComposition}"
                                              IsReadOnly="True"
                                              CanUserAddRows="False"
                                              CanUserDeleteRows="False"
                                              CanUserReorderColumns="False"
                                              CanUserResizeRows="False"
                                              CanUserSortColumns="False"
                                              AutoGenerateColumns="False"
                                              HeadersVisibility="Column"
                                              GridLinesVisibility="All"
                                              BorderBrush="#CCC"
                                              BorderThickness="1"
                                              Background="White"
                                              RowBackground="White"
                                              AlternatingRowBackground="#F8F8F8"
                                              Margin="0,0,0,8">
                                        <DataGrid.ColumnHeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="#333"/>
                                                <Setter Property="Foreground" Value="White"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.ColumnHeaderStyle>
                                        <DataGrid.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="Padding" Value="4"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.CellStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="#" Binding="{Binding No}" Width="40">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" MinWidth="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="4,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Thickness [µm]" Binding="{Binding Thickness_um, StringFormat=F2}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Porosity [%]" Binding="{Binding Porosity_pct, StringFormat=F2}" Width="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Density [g/cm³]" Binding="{Binding Density_gcm3, StringFormat=F4}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <!-- Package Material Properties -->
                                    <TextBlock Text="Package Material Properties" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                                    <Border Background="#F0F0F0" BorderBrush="#CCC" BorderThickness="1" Padding="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Thickness (sum) -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Thickness (sum)" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="[um]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageThicknessSum_um, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageThicknessNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Areal Weight -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Areal Weight" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="[mg/cm²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageArealWeight_mgcm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageArealWeightNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Effective Density -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Effective Density" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="[g/cm³]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageEffDensity_gcm3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageEffDensityNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Cost -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Cost" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="[€/m²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageCost_EURm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding PackageCostNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                        </Grid>
                                    </Border>

                                    <!-- Pouch Foil Offset -->
                                    <TextBlock Text="Pouch foil Offset to Separator" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Top" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                 Text="{Binding PouchOffsetTop_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Bottom" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                 Text="{Binding PouchOffsetBottom_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Left Side" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                 Text="{Binding PouchOffsetLeft_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Right Side" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                 Text="{Binding PouchOffsetRight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                    </Grid>

                                    <!-- Calculated Cell Dimensions -->
                                    <TextBlock Text="Cell Dimensions" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Calculated Cell height" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                 Text="{Binding CalculatedHeight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Calculated Cell width" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                 Text="{Binding CalculatedWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                    </Grid>

                                    <!-- Measured Dimensions -->
                                    <CheckBox Content="Update Cell Dimension based on measurement" FontWeight="SemiBold" Margin="0,16,0,8"
                                              IsChecked="{Binding UseMeasuredDims, Mode=TwoWay}"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Measured Cell height" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                 Text="{Binding MeasuredHeight_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Measured Cell width" VerticalAlignment="Center" Margin="4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                        <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                 Text="{Binding MeasuredWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                    </Grid>
                                </StackPanel>
                            </Grid>

                            <!-- TABS SUB-TAB -->
                            <Grid x:Name="SubPanelTabs" Visibility="{Binding IsChecked, ElementName=SubTabTabs, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <TextBlock Text="Packaging / Tabs" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>
                                    <TextBlock Text="Tab Design" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,8"/>

                                    <!-- Tab Design Table -->
                                    <Border BorderBrush="#CCC" BorderThickness="1">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="250"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Header Row -->
                                            <Border Grid.Row="0" Grid.Column="0" Background="#333" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Tab Design" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="1" Background="#333" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="" Foreground="White" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="2" Background="#333" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Anode" Foreground="White" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="3" Background="#333" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Cathode" Foreground="White" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>

                                            <!-- Tab Material (ComboBox - editable) -->
                                            <Border Grid.Row="1" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Tab Material" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="—" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <ComboBox Text="{Binding AnodeTabMaterial, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          IsEditable="True"
                                                          Background="Black" Foreground="White" FontWeight="Bold" Margin="4">
                                                    <ComboBoxItem Content="Copper mix"/>
                                                    <ComboBoxItem Content="Copper foil"/>
                                                    <ComboBoxItem Content="Aluminum foil"/>
                                                    <ComboBoxItem Content="Nickel-plated copper"/>
                                                </ComboBox>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <ComboBox Text="{Binding CathodeTabMaterial, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          IsEditable="True"
                                                          Background="Black" Foreground="White" FontWeight="Bold" Margin="4">
                                                    <ComboBoxItem Content="Aluminum"/>
                                                    <ComboBoxItem Content="Copper mix"/>
                                                    <ComboBoxItem Content="Copper foil"/>
                                                    <ComboBoxItem Content="Aluminum foil"/>
                                                    <ComboBoxItem Content="Nickel-plated copper"/>
                                                </ComboBox>
                                            </Border>

                                            <!-- Version (ComboBox - editable) -->
                                            <Border Grid.Row="2" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Version" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="—" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <ComboBox SelectedValue="{Binding AnodeTabVersion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          SelectedValuePath="Tag"
                                                          Background="Black" Foreground="White" FontWeight="Bold" Margin="4">
                                                    <ComboBoxItem Content="1 – 01.10.25" Tag="1"/>
                                                    <ComboBoxItem Content="2 – 15.09.25" Tag="2"/>
                                                    <ComboBoxItem Content="3 – 20.08.25" Tag="3"/>
                                                </ComboBox>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <ComboBox SelectedValue="{Binding CathodeTabVersion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          SelectedValuePath="Tag"
                                                          Background="Black" Foreground="White" FontWeight="Bold" Margin="4">
                                                    <ComboBoxItem Content="1 – 01.10.25" Tag="1"/>
                                                    <ComboBoxItem Content="2 – 15.09.25" Tag="2"/>
                                                    <ComboBoxItem Content="3 – 20.08.25" Tag="3"/>
                                                </ComboBox>
                                            </Border>

                                            <!-- Height [mm] (Read-only) -->
                                            <Border Grid.Row="3" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Height" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding AnodeTabHeight_mm, Mode=OneWay, StringFormat=F1}"
                                                         Margin="4"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding CathodeTabHeight_mm, Mode=OneWay, StringFormat=F1}"
                                                         Margin="4"/>
                                            </Border>

                                            <!-- Width [mm] (Read-only) -->
                                            <Border Grid.Row="4" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Width" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="4" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="4" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding AnodeTabWidth_mm, Mode=OneWay, StringFormat=F1}"
                                                         Margin="4"/>
                                            </Border>
                                            <Border Grid.Row="4" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding CathodeTabWidth_mm, Mode=OneWay, StringFormat=F1}"
                                                         Margin="4"/>
                                            </Border>

                                            <!-- Thickness [mm] (Read-only) -->
                                            <Border Grid.Row="5" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Thickness" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="5" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="5" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding AnodeTabThickness_mm, Mode=OneWay, StringFormat=F2}"
                                                         Margin="4"/>
                                            </Border>
                                            <Border Grid.Row="5" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding CathodeTabThickness_mm, Mode=OneWay, StringFormat=F2}"
                                                         Margin="4"/>
                                            </Border>

                                            <!-- Overlap distance with flags [mm] (Read-only) -->
                                            <Border Grid.Row="6" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Overlap distance with flags" VerticalAlignment="Center" TextWrapping="Wrap"/>
                                            </Border>
                                            <Border Grid.Row="6" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="6" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding AnodeTabOverlap_mm, Mode=OneWay, StringFormat=F1}"
                                                         Margin="4"/>
                                            </Border>
                                            <Border Grid.Row="6" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding CathodeTabOverlap_mm, Mode=OneWay, StringFormat=F1}"
                                                         Margin="4"/>
                                            </Border>

                                            <!-- Calculated Mass [g] (Read-only) -->
                                            <Border Grid.Row="7" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Calculated Mass" VerticalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="7" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="7" Grid.Column="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding AnodeTabMass_g, Mode=OneWay, StringFormat=F2}"
                                                         Margin="4"/>
                                            </Border>
                                            <Border Grid.Row="7" Grid.Column="3" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding CathodeTabMass_g, Mode=OneWay, StringFormat=F2}"
                                                         Margin="4"/>
                                            </Border>

                                            <!-- Total tab mass per cell [g] (Read-only, spans Anode+Cathode columns) -->
                                            <Border Grid.Row="8" Grid.Column="0" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="Total tab mass per cell" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                            <Border Grid.Row="8" Grid.Column="1" Background="#E0E0E0" Padding="4" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBlock Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <Border Grid.Row="8" Grid.Column="2" Grid.ColumnSpan="2" Padding="2" BorderBrush="#CCC" BorderThickness="1">
                                                <TextBox Style="{StaticResource CalcTextBox}"
                                                         Text="{Binding TotalTabMassPerCell_g, Mode=OneWay, StringFormat=F2}"
                                                         HorizontalAlignment="Stretch"
                                                         Margin="4"/>
                                            </Border>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </Grid>

                            <!-- ADDITIONAL FOILS SUB-TAB -->
                            <Grid x:Name="SubPanelAddFoils" Visibility="{Binding IsChecked, ElementName=SubTabAddFoils, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <TextBlock Text="Packaging / Add. Foils" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

                                    <!-- ========== OVERWRAP SECTION ========== -->
                                    <TextBlock Text="Overwrap" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,12"/>

                                    <!-- Overwrap Material Composition Table -->
                                    <TextBlock Text="Overwrap Material Composition" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                    <DataGrid ItemsSource="{Binding OverwrapComposition}"
                                              IsReadOnly="False"
                                              CanUserAddRows="False"
                                              CanUserDeleteRows="False"
                                              CanUserReorderColumns="False"
                                              CanUserResizeRows="False"
                                              CanUserSortColumns="False"
                                              AutoGenerateColumns="False"
                                              HeadersVisibility="Column"
                                              GridLinesVisibility="All"
                                              BorderBrush="#CCC"
                                              BorderThickness="1"
                                              Background="White"
                                              RowBackground="White"
                                              AlternatingRowBackground="#F8F8F8"
                                              Margin="0,0,0,8">
                                        <DataGrid.ColumnHeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="#333"/>
                                                <Setter Property="Foreground" Value="White"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.ColumnHeaderStyle>
                                        <DataGrid.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="Padding" Value="4"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.CellStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="#" Binding="{Binding No}" Width="40">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" MinWidth="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="4,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridComboBoxColumn Header="Version"
                                                                    SelectedItemBinding="{Binding Version, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                    Width="140">
                                                <DataGridComboBoxColumn.ElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding DataContext.OverwrapMaterialPresets, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Background" Value="Black"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Style>
                                                </DataGridComboBoxColumn.ElementStyle>
                                                <DataGridComboBoxColumn.EditingElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding DataContext.OverwrapMaterialPresets, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                                        <Setter Property="Background" Value="Black"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Style>
                                                </DataGridComboBoxColumn.EditingElementStyle>
                                            </DataGridComboBoxColumn>
                                            <DataGridTextColumn Header="Thickness [µm]" Binding="{Binding Thickness_um, StringFormat=F2}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Porosity [%]" Binding="{Binding Porosity_pct, StringFormat=F2}" Width="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Density [g/cm³]" Binding="{Binding Density_gcm3, StringFormat=F4}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <!-- Overwrap Material Properties -->
                                    <TextBlock Text="Overwrap Material Properties" FontSize="14" FontWeight="SemiBold" Margin="0,16,0,8"/>
                                    <Border Background="#F0F0F0" BorderBrush="#CCC" BorderThickness="1" Padding="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Thickness (sum) -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Thickness (sum)" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="[µm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding OverwrapThicknessSum_um, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding OverwrapThicknessNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Areal Weight -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Areal Weight" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="[mg/cm²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding OverwrapArealWeight_mgcm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F3}" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding OverwrapArealWeightNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Effective Density -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Effective Density" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="[g/cm³]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding OverwrapEffDensity_gcm3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F4}" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding OverwrapEffDensityNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Cost -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Cost" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="[€/m²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding OverwrapCost_EURm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding OverwrapCostNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                        </Grid>
                                    </Border>

                                    <!-- ========== INSULATION SHELL SECTION ========== -->
                                    <TextBlock Text="Insulation Shell" FontSize="16" FontWeight="SemiBold" Margin="0,32,0,12"/>

                                    <!-- Insulation Shell Material Composition Table -->
                                    <TextBlock Text="Insulation Shell Material Composition" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                    <DataGrid ItemsSource="{Binding InsShellComposition}"
                                              IsReadOnly="False"
                                              CanUserAddRows="False"
                                              CanUserDeleteRows="False"
                                              CanUserReorderColumns="False"
                                              CanUserResizeRows="False"
                                              CanUserSortColumns="False"
                                              AutoGenerateColumns="False"
                                              HeadersVisibility="Column"
                                              GridLinesVisibility="All"
                                              BorderBrush="#CCC"
                                              BorderThickness="1"
                                              Background="White"
                                              RowBackground="White"
                                              AlternatingRowBackground="#F8F8F8"
                                              Margin="0,0,0,8">
                                        <DataGrid.ColumnHeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="#333"/>
                                                <Setter Property="Foreground" Value="White"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.ColumnHeaderStyle>
                                        <DataGrid.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="Padding" Value="4"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.CellStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="#" Binding="{Binding No}" Width="40">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" MinWidth="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="4,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridComboBoxColumn Header="Version"
                                                                    SelectedItemBinding="{Binding Version, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                    Width="140">
                                                <DataGridComboBoxColumn.ElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding DataContext.InsShellMaterialPresets, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Background" Value="Black"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Style>
                                                </DataGridComboBoxColumn.ElementStyle>
                                                <DataGridComboBoxColumn.EditingElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding DataContext.InsShellMaterialPresets, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                                        <Setter Property="Background" Value="Black"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Style>
                                                </DataGridComboBoxColumn.EditingElementStyle>
                                            </DataGridComboBoxColumn>
                                            <DataGridTextColumn Header="Thickness [µm]" Binding="{Binding Thickness_um, StringFormat=F2}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Porosity [%]" Binding="{Binding Porosity_pct, StringFormat=F2}" Width="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Density [g/cm³]" Binding="{Binding Density_gcm3, StringFormat=F4}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <!-- Insulation Shell Material Properties -->
                                    <TextBlock Text="Insulation Shell Material Properties" FontSize="14" FontWeight="SemiBold" Margin="0,16,0,8"/>
                                    <Border Background="#F0F0F0" BorderBrush="#CCC" BorderThickness="1" Padding="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Thickness (sum) -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Thickness (sum)" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="[µm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding InsShellThicknessSum_um, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding InsShellThicknessNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Areal Weight -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Areal Weight" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="[mg/cm²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding InsShellArealWeight_mgcm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F3}" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding InsShellArealWeightNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Effective Density -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Effective Density" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="[g/cm³]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding InsShellEffDensity_gcm3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F4}" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding InsShellEffDensityNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Cost -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Cost" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="[€/m²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding InsShellCost_EURm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding InsShellCostNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </Grid>

                            <!-- INSULATION SHELL SUB-TAB -->
                            <Grid x:Name="SubPanelInsulationShell" Visibility="{Binding IsChecked, ElementName=SubTabInsulationShell, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                </StackPanel>
                            </Grid>

                            <!-- FIXING TAPE SUB-TAB -->
                            <Grid x:Name="SubPanelFixingTape" Visibility="{Binding IsChecked, ElementName=SubTabFixingTape, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <TextBlock Text="Packaging / Fixing Tape" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

                                    <!-- Material and Version Selection Row -->
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="20"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="200"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="Fixing Tape Material" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                        <ComboBox Grid.Column="1"
                                                  ItemsSource="{Binding FixingTapeMaterialPresets}"
                                                  SelectedItem="{Binding FixingTapeMaterial, Mode=TwoWay}"
                                                  Background="Black" Foreground="White"
                                                  VerticalAlignment="Center"/>

                                        <TextBlock Grid.Column="3" Text="Version" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                        <ComboBox Grid.Column="4"
                                                  ItemsSource="{Binding FixingTapeVersionPresets}"
                                                  SelectedItem="{Binding FixingTapeVersion, Mode=TwoWay}"
                                                  Background="Black" Foreground="White"
                                                  VerticalAlignment="Center"/>
                                    </Grid>

                                    <!-- Fixing Tape Material Composition Table -->
                                    <TextBlock Text="Fixing Tape Material Composition" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                                    <DataGrid ItemsSource="{Binding FixingTapeComposition}"
                                              IsReadOnly="False"
                                              CanUserAddRows="False"
                                              CanUserDeleteRows="False"
                                              CanUserReorderColumns="False"
                                              CanUserResizeRows="False"
                                              CanUserSortColumns="False"
                                              AutoGenerateColumns="False"
                                              HeadersVisibility="Column"
                                              GridLinesVisibility="All"
                                              BorderBrush="#CCC"
                                              BorderThickness="1"
                                              Background="White"
                                              RowBackground="White"
                                              AlternatingRowBackground="#F8F8F8"
                                              Margin="0,0,0,8">
                                        <DataGrid.ColumnHeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Background" Value="#333"/>
                                                <Setter Property="Foreground" Value="White"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.ColumnHeaderStyle>
                                        <DataGrid.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="Padding" Value="4"/>
                                                <Setter Property="BorderBrush" Value="#CCC"/>
                                                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            </Style>
                                        </DataGrid.CellStyle>
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="#" Binding="{Binding No}" Width="40">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" MinWidth="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="4,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridComboBoxColumn Header="Version"
                                                                    SelectedItemBinding="{Binding Version, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                    Width="140">
                                                <DataGridComboBoxColumn.ElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding DataContext.FixingTapeVersionPresets, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Background" Value="Black"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Style>
                                                </DataGridComboBoxColumn.ElementStyle>
                                                <DataGridComboBoxColumn.EditingElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding DataContext.FixingTapeVersionPresets, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                                        <Setter Property="Background" Value="Black"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Style>
                                                </DataGridComboBoxColumn.EditingElementStyle>
                                            </DataGridComboBoxColumn>
                                            <DataGridTextColumn Header="Thickness [µm]" Binding="{Binding Thickness_um, StringFormat=F2}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Porosity [%]" Binding="{Binding Porosity_pct, StringFormat=F2}" Width="120">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                            <DataGridTextColumn Header="Density [g/cm³]" Binding="{Binding Density_gcm3, StringFormat=F4}" Width="140">
                                                <DataGridTextColumn.ElementStyle>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                                        <Setter Property="Margin" Value="0,0,8,0"/>
                                                    </Style>
                                                </DataGridTextColumn.ElementStyle>
                                            </DataGridTextColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>

                                    <!-- Fixing Tape Material Properties -->
                                    <TextBlock Text="Fixing Tape Material Properties" FontSize="14" FontWeight="SemiBold" Margin="0,16,0,8"/>
                                    <Border Background="#F0F0F0" BorderBrush="#CCC" BorderThickness="1" Padding="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Thickness (sum) -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Thickness (sum)" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="[µm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeThicknessSum_um, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeThicknessNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Areal Weight -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Areal Weight" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="[mg/cm²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding FixingTapeArealWeight_mgcm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F3}" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeArealWeightNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Effective Density -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Effective Density" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="[g/cm³]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding FixingTapeEffDensity_gcm3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F4}" Margin="4"/>
                                            <TextBox Grid.Row="2" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeEffDensityNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>

                                            <!-- Cost -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Cost" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="[€/m²]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                     Text="{Binding FixingTapeCost_EURm2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="4"/>
                                            <TextBox Grid.Row="3" Grid.Column="3" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeCostNote, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="4"/>
                                        </Grid>
                                    </Border>

                                    <!-- Fixing Tape Geometry -->
                                    <TextBlock Text="Fixing Tape Geometry" FontSize="14" FontWeight="SemiBold" Margin="0,24,0,8"/>
                                    <Border Background="#F0F0F0" BorderBrush="#CCC" BorderThickness="1" Padding="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="150"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Tape width -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Tape width" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeWidth_mm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F1}" Margin="4"/>

                                            <!-- Total tape length -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Total tape length" VerticalAlignment="Center" Margin="4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="[cm]" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="4"/>
                                            <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource InputTextBox}"
                                                     Text="{Binding FixingTapeTotalLength_cm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=F1}" Margin="4"/>
                                        </Grid>
                                    </Border>

                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Grid>

                    <!-- REPORT TAB -->
                    <Grid x:Name="PanelReport" Visibility="{Binding IsChecked, ElementName=TabReport, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <!-- CORE SUB-TAB -->
                            <Grid x:Name="SubPanelReportCore" Visibility="{Binding IsChecked, ElementName=SubTabReportCore, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <TextBlock Text="Report / Core" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

                                    <!-- Report Content Grid -->
                                    <Border Background="#E8E8E8" BorderBrush="#CCC" BorderThickness="1" Padding="24" Margin="0,0,0,16">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="1*"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="1*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- LEFT COLUMN -->
                                            <StackPanel Grid.Column="0">
                                                <!-- Energy density -->
                                                <TextBlock Text="Energy density" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Grav. energy density" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="[Wh/kg]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding GravEnergyDensity_Whkg, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Vol. energy density (Cell)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[Wh/l]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding VolEnergyDensity_Cell_Whl, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Vol. energy density (Stack)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[Wh/l]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding VolEnergyDensity_Stack_Whl, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Vol. energy density (ECU)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="[Wh/l]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding VolEnergyDensity_ECU_Whl, Mode=OneWay, StringFormat=F0}" Margin="4"/>
                                                </Grid>

                                                <!-- Construction -->
                                                <TextBlock Text="Construction" FontWeight="SemiBold" FontSize="14" Margin="0,8,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Efficiency" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="" VerticalAlignment="Center" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Stack" VerticalAlignment="Center" Margin="4,4,4,4" FontStyle="Italic"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[%]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Efficiency_Stack_pct, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="ECU" VerticalAlignment="Center" Margin="4,4,4,4" FontStyle="Italic"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[%]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Efficiency_ECU_pct, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                </Grid>

                                                <!-- Electrical characteristics -->
                                                <TextBlock Text="Electrical characteristics" FontWeight="SemiBold" FontSize="14" Margin="0,8,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Cell capacity" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="[Ah]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellCapacity_Ah, Mode=OneWay, StringFormat=F3}" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Cell energy" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[Wh]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellEnergy_Wh, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Nom. voltage" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[V]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding NominalVoltage_V, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Average Overpotential" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="[mV]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding AverageOverpotential_mV, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Areal capacity" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="1" Text="[mAh/cm²]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ArealCapacity_mAhcm2, Mode=OneWay, StringFormat=F3}" Margin="4"/>

                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Areal energy" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="1" Text="[mWh/cm²]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ArealEnergy_mWhcm2, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="U min" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="6" Grid.Column="1" Text="[V]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="6" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Umin_V, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="7" Grid.Column="0" Text="U max" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="7" Grid.Column="1" Text="[V]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="7" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Umax_V, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                </Grid>

                                                <!-- Number of Sheets in Cell -->
                                                <TextBlock Text="Number of Sheets in Cell" FontWeight="SemiBold" FontSize="14" Margin="0,8,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="20"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Cathode Sheets" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="/" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CathodeSheets_Cell, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Anode Sheets" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="/" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding AnodeSheets_Cell, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Electrode Sheets" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="/" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding AllElectrodeSheets_Cell, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Separator Sheets" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="/" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding SeparatorSheets_Cell, Mode=OneWay, StringFormat=F0}" Margin="4"/>
                                                </Grid>
                                            </StackPanel>

                                            <!-- RIGHT COLUMN -->
                                            <StackPanel Grid.Column="2">
                                                <!-- Volume -->
                                                <TextBlock Text="Volume" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="ECU" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="[cm³]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Volume_ECU_cm3, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Stack" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[cm³]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Volume_Stack_cm3, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Cell (pouch box)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[cm³]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding Volume_CellBox_cm3, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                </Grid>

                                                <!-- Cell Dimensions -->
                                                <TextBlock Text="Cell Dimensions" FontWeight="SemiBold" FontSize="14" Margin="0,8,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Height" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellHeight_mm, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Width" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellWidth_mm, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Thickness (dry)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellThickness_Dry_mm, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Thickness (0% SoC)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellThickness_SoC0_mm, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Thickness (100% SoC)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="1" Text="[mm]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellThickness_SoC100_mm, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Formation swelling" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="1" Text="[%]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding FormationSwelling_pct, Mode=OneWay, StringFormat=F2}" Margin="4"/>

                                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="SoC breathing" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="6" Grid.Column="1" Text="[%]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="6" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding SoCBreathing_pct, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                </Grid>

                                                <!-- Areal Characteristics -->
                                                <TextBlock Text="Areal Characteristics" FontWeight="SemiBold" FontSize="14" Margin="0,8,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="100"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Cathode coating (active area)" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="[m²]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CathodeActiveArea_m2, Mode=OneWay, StringFormat=F0}" Margin="4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Anode coating" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[m²]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding AnodeActiveArea_m2, Mode=OneWay, StringFormat=F1}" Margin="4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Separator" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[m²]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding SeparatorArea_m2, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                </Grid>

                                                <!-- Mass summary -->
                                                <TextBlock Text="Mass summary" FontWeight="SemiBold" FontSize="14" Margin="0,8,0,8"/>
                                                <Grid Margin="0,0,0,16">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="60"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Cell" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CellMass_g, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="3" Text="{Binding CellNameReport, Mode=OneWay}"
                                                               VerticalAlignment="Center" Margin="8,4,4,4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Cathode" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding CathodeMass_g, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="3" Text="{Binding CathodeMaterialName, Mode=OneWay}"
                                                               VerticalAlignment="Center" Margin="8,4,4,4"/>

                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Anode" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding AnodeMass_g, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="3" Text="{Binding AnodeMaterialName, Mode=OneWay}"
                                                               VerticalAlignment="Center" Margin="8,4,4,4"/>

                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Electrolyte" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ElectrolyteMass_g, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="3" Text="{Binding ElectrolyteName, Mode=OneWay}"
                                                               VerticalAlignment="Center" Margin="8,4,4,4"/>

                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Separator" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="1" Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding SeparatorMass_g, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="3" Text="{Binding SeparatorName, Mode=OneWay}"
                                                               VerticalAlignment="Center" Margin="8,4,4,4"/>

                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Housing" VerticalAlignment="Center" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="1" Text="[g]" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding HousingMass_g, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="3" Text="{Binding HousingName, Mode=OneWay}"
                                                               VerticalAlignment="Center" Margin="8,4,4,4"/>
                                                </Grid>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </Grid>

                            <!-- COMP. SUB-TAB -->
                            <Grid x:Name="SubPanelReportComp" Visibility="{Binding IsChecked, ElementName=SubTabReportComp, Converter={StaticResource BoolToVis}}">
                                <Border Background="#E8E8E8" Padding="16" CornerRadius="4">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="16"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- LEFT COLUMN: Cathode, Anode, Separator -->
                                        <StackPanel Grid.Column="0">
                                            <!-- Cathode Characteristics -->
                                            <TextBlock Text="Cathode Characteristics" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
                                            <Border Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="12" Margin="0,0,0,16">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="260"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="80"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Header: Material Name -->
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Material Name" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeName, Mode=OneWay}" Margin="4,0,0,4"/>

                                                    <!-- Loading -->
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Loading" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeLoading_mgcm2, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="[mg/cm²]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Rev. specific capacity -->
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Rev. specific capacity" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeRevSpecCapacity_mAhg, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="2" Text="[mAh/g]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- C/3 specific capacity vs. Li -->
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="C/3 specific capacity vs. Li" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeC3SpecCapacity_mAhg, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="2" Text="[mAh/g]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating thickness single (0%) -->
                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Coating thickness single (0%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeCoatingThk_0pct_um, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="2" Text="[µm]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating thickness single (100%) -->
                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Coating thickness single (100%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeCoatingThk_100pct_um, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="2" Text="[µm]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating density (0%) -->
                                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Coating density (0%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="6" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeCoatingDensity_0pct_gcm3, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="6" Grid.Column="2" Text="[g/cm³]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating density (100%) -->
                                                    <TextBlock Grid.Row="7" Grid.Column="0" Text="Coating density (100%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="7" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportCathodeCoatingDensity_100pct_gcm3, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="7" Grid.Column="2" Text="[g/cm³]" VerticalAlignment="Center" Margin="4"/>
                                                </Grid>
                                            </Border>

                                            <!-- Anode Characteristics -->
                                            <TextBlock Text="Anode Characteristics" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
                                            <Border Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="12" Margin="0,0,0,16">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="260"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="80"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Header: Material Name -->
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Material Name" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeName, Mode=OneWay}" Margin="4,0,0,4"/>

                                                    <!-- Loading -->
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Loading" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeLoading_mgcm2, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="[mg/cm²]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Rev. specific capacity -->
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Rev. specific capacity" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeRevSpecCapacity_mAhg, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="2" Text="[mAh/g]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- C/3 specific capacity vs. Li -->
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="C/3 specific capacity vs. Li" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeC3SpecCapacity_mAhg, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="2" Text="[mAh/g]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating thickness single (0%) -->
                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Coating thickness single (0%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeCoatingThk_0pct_um, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="2" Text="[µm]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating thickness single (100%) -->
                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Coating thickness single (100%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeCoatingThk_100pct_um, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="2" Text="[µm]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating density (0%) -->
                                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Coating density (0%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="6" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeCoatingDensity_0pct_gcm3, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="6" Grid.Column="2" Text="[g/cm³]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Coating density (100%) -->
                                                    <TextBlock Grid.Row="7" Grid.Column="0" Text="Coating density (100%)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="7" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportAnodeCoatingDensity_100pct_gcm3, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="7" Grid.Column="2" Text="[g/cm³]" VerticalAlignment="Center" Margin="4"/>
                                                </Grid>
                                            </Border>

                                            <!-- Separator -->
                                            <TextBlock Text="Separator" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
                                            <Border Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="12" Margin="0,0,0,16">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="260"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="80"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Header: Material Name -->
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Material Name" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportSeparatorName, Mode=OneWay}" Margin="4,0,0,4"/>

                                                    <!-- Thickness -->
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Thickness" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportSeparatorThickness_um, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="[µm]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Porosity -->
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Porosity" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportSeparatorPorosity_pct, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="2" Text="[%]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Areal weight -->
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Areal weight" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportSeparatorArealWeight_mgcm2, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="2" Text="[mg/cm²]" VerticalAlignment="Center" Margin="4"/>
                                                </Grid>
                                            </Border>
                                        </StackPanel>

                                        <!-- RIGHT COLUMN: Electrolyte, Heat Capacity, Thermal Conductivity -->
                                        <StackPanel Grid.Column="2">
                                            <!-- Electrolyte -->
                                            <TextBlock Text="Electrolyte" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
                                            <Border Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="12" Margin="0,0,0,16">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="260"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="80"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Header: Material Name -->
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Material Name" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolyteName, Mode=OneWay}" Margin="4,0,0,4"/>

                                                    <!-- Pores anode (0% SoC) -->
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Pores anode (0% SoC)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolytePoresAnode_0pctSoC_ml, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="[ml]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Pores cathode (0% SoC) -->
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Pores cathode (0% SoC)" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolytePoresCathode_0pctSoC_ml, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="2" Text="[ml]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Pores separator -->
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Pores separator" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolytePoresSeparator_ml, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="2" Text="[ml]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Calculated volume -->
                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Calculated volume" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolyteCalcVolume_ml, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="2" Text="[ml]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Used volume -->
                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Used volume" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolyteUsedVolume_ml, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="2" Text="[ml]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Excess factor -->
                                                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Excess factor" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="6" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolyteExcessFactor, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="6" Grid.Column="2" Text="[/]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Calculated volume / capacity -->
                                                    <TextBlock Grid.Row="7" Grid.Column="0" Text="Calculated volume / capacity" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="7" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolyteCalcVolumeCapacity_mlAh, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="7" Grid.Column="2" Text="[ml/Ah]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Used volume / capacity -->
                                                    <TextBlock Grid.Row="8" Grid.Column="0" Text="Used volume / capacity" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="8" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportElectrolyteUsedVolumeCapacity_mlAh, Mode=OneWay, StringFormat=F2}" Margin="4"/>
                                                    <TextBlock Grid.Row="8" Grid.Column="2" Text="[ml/Ah]" VerticalAlignment="Center" Margin="4"/>
                                                </Grid>
                                            </Border>

                                            <!-- Heat Capacity -->
                                            <TextBlock Text="Heat Capacity" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
                                            <Border Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="12" Margin="0,0,0,16">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="260"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="80"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Cell -->
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Cell" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportHeatCapacityCell_JgK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="[J/g·K]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Cathode -->
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Cathode" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportHeatCapacityCathode_JgK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="[J/g·K]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Anode -->
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Anode" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportHeatCapacityAnode_JgK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="2" Text="[J/g·K]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Electrolyte -->
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Electrolyte" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="3" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportHeatCapacityElectrolyte_JgK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="2" Text="[J/g·K]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Separator -->
                                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Separator" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="4" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportHeatCapacitySeparator_JgK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="4" Grid.Column="2" Text="[J/g·K]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Case -->
                                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Case" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="5" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportHeatCapacityCase_JgK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="5" Grid.Column="2" Text="[J/g·K]" VerticalAlignment="Center" Margin="4"/>
                                                </Grid>
                                            </Border>

                                            <!-- Thermal Conductivity -->
                                            <TextBlock Text="Thermal Conductivity" FontSize="16" FontWeight="Bold" Margin="0,0,0,8"/>
                                            <Border Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="12" Margin="0,0,0,16">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="260"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="80"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Pos. collector share in Z -->
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Pos. collector share in Z" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportThermalCondPosCollectorShareZ_pct, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="[%]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Neg. collector share in Z -->
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Neg. collector share in Z" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportThermalCondNegCollectorShareZ_pct, Mode=OneWay, StringFormat=F1}" Margin="4"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="[%]" VerticalAlignment="Center" Margin="4"/>

                                                    <!-- Stack in X/Y -->
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Stack in X/Y" VerticalAlignment="Center" Margin="0,4"/>
                                                    <TextBox Grid.Row="2" Grid.Column="1" Style="{StaticResource CalcTextBox}"
                                                             Text="{Binding ReportThermalCondStackXY_WmK, Mode=OneWay, StringFormat=F3}" Margin="4"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="2" Text="[W/m·K]" VerticalAlignment="Center" Margin="4"/>
                                                </Grid>
                                            </Border>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Grid>

                </StackPanel>
            </Border>

        <!-- ========== SPLITTER ========== -->
        <!-- Visible for Sheet Design tab -->
        <GridSplitter Grid.Column="2"
                      Width="5"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Background="#555"
                      ShowsPreview="False"
                      Visibility="{Binding IsChecked, ElementName=TabSheetDesign, Converter={StaticResource BoolToVis}}"/>

        <!-- Splitter for Case tab -->
        <Grid Grid.Column="2" Visibility="{Binding Visibility, ElementName=PanelPackaging}">
            <GridSplitter Width="5"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Background="#555"
                          ShowsPreview="False"
                          Visibility="{Binding IsChecked, ElementName=SubTabCase, Converter={StaticResource BoolToVis}}"/>
        </Grid>

        <!-- ========== RIGHT: 3D VIEWPORT + 2D SCHEMATIC ========== -->
        <!-- Only visible for Sheet Design tab -->
        <Grid Grid.Column="3" Visibility="{Binding IsChecked, ElementName=TabSheetDesign, Converter={StaticResource BoolToVis}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" MinHeight="400"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="300" MinHeight="200"/>
            </Grid.RowDefinitions>

            <!-- Top: Full Sheet Layout -->
            <Border Grid.Row="0" Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Border Grid.Row="0" Background="#F0F0F0" Padding="8,4" BorderBrush="#CCC" BorderThickness="0,0,0,1">
                        <TextBlock Text="Simple plot of full sheet layout" FontWeight="SemiBold" FontSize="12"/>
                    </Border>

                    <!-- Canvas -->
                    <Border Grid.Row="1" Background="#1A1A1C">
                        <ContentControl x:Name="ViewportHost"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Middle: Splitter -->
            <GridSplitter Grid.Row="1" 
                          Height="5" 
                          HorizontalAlignment="Stretch" 
                          VerticalAlignment="Stretch"
                          Background="#555"
                          ShowsPreview="False"/>

            <!-- Bottom: 2D Schematic -->
            <Border Grid.Row="2" Background="White" BorderBrush="#CCC" BorderThickness="1" Padding="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Border Grid.Row="0" Background="#F0F0F0" Padding="8,4" BorderBrush="#CCC" BorderThickness="0,0,0,1">
                        <TextBlock Text="Simple plot of sheets with zoom in on the corner for offsets view" FontWeight="SemiBold" FontSize="12"/>
                    </Border>

                    <!-- Schematic Canvas -->
                    <Border Grid.Row="1" x:Name="SchematicHost" Background="White"/>
                </Grid>
            </Border>
        </Grid>

        <!-- ========== RIGHT: CASE PREVIEW ========== -->
        <!-- Only visible for Packaging → Case sub-tab -->
        <Grid Grid.Column="3" Visibility="{Binding Visibility, ElementName=PanelPackaging}">
            <Border Visibility="{Binding IsChecked, ElementName=SubTabCase, Converter={StaticResource BoolToVis}}"
                    BorderBrush="#33000000"
                    BorderThickness="1"
                    Background="#08000000"
                    Padding="12"
                    SnapsToDevicePixels="True">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Preview Title -->
                    <TextBlock Grid.Row="0"
                               Text="Simple 2D plotting of foils and separator over pouch foil"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8"
                               TextWrapping="Wrap"/>

                    <!-- Preview Canvas with Axis Labels -->
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Y Axis Label -->
                        <TextBlock Grid.Column="0" Grid.Row="0"
                                   Text="Y"
                                   FontSize="11"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,4,0"/>

                        <!-- Canvas -->
                        <Canvas x:Name="CasePreviewCanvas"
                                Grid.Column="1" Grid.Row="0"
                                Background="White"
                                Focusable="False"
                                ClipToBounds="True"
                                Margin="8"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"/>

                        <!-- X Axis Label -->
                        <TextBlock Grid.Column="1" Grid.Row="1"
                                   Text="X"
                                   FontSize="11"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,4,0,0"/>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</ScrollViewer>
</Grid>

<!--
====================================================================================================
ORIGINAL LAYOUT (before global ScrollViewer refactor - for easy revert if needed)
====================================================================================================

The original layout had the ScrollViewer only wrapping Grid.Column="1" (center panel):

<Grid Grid.Row="1">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="160" MinWidth="120"/>
        <ColumnDefinition Width="450" MinWidth="400" MaxWidth="700"/>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*" MinWidth="500"/>
    </Grid.ColumnDefinitions>

    <Border Grid.Column="0" Background="#f5f5f5" BorderBrush="#ccc" BorderThickness="0,0,1,0">
        [Navigation sidebar content]
    </Border>

    <ScrollViewer Grid.Column="1"
                  VerticalScrollBarVisibility="Auto"
                  CanContentScroll="True">
        <Border Padding="16">
            <StackPanel>
                [All panels content]
            </StackPanel>
        </Border>
    </ScrollViewer>

    <GridSplitter Grid.Column="2" ... />

    <Grid Grid.Column="3">
        [Preview panels]
    </Grid>
</Grid>

To revert: Replace the new global ScrollViewer structure with this original layout.
====================================================================================================
-->

</Window>
